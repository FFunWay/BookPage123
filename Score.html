<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>學習診斷</title>
    <link rel="stylesheet" href="CSS/sorce.css">
</head>
<body>
    <button id="back-button" class="back-button">返回</button>
    <div class="hero-section">
        <h1>學習診斷</h1>
        <p></p>
    </div>

    <!-- DIVE得分进度条 -->
    <div class="label">運算思維掌握度</div>
    <div class="progress-container">
        <div id="computationProgress" class="progress-bar">0%</div>
    </div>

    <div class="label">音樂思維掌握度</div>
    <div class="progress-container">
        <div id="musicProgress" class="progress-bar">0%</div>
    </div>

    <div class="label">瞇瞇瞇</div>
    <div class="progress-container">
        <div id="diveProgress" class="progress-bar">0%</div>
    </div>

    <script>
        // 返回繪本內容，取得 URL 參數中的 PDF 文件名
        const urlParams = new URLSearchParams(window.location.search);
        const pdfFile = urlParams.get('pdf') || 'default.pdf'; // 默認 PDF 文件

        console.log(`返回要載入PDF: ${pdfFile}`);

        // 返回按鈕點擊事件，帶著 PDF 文件參數返回到 viewer.html
        document.getElementById('back-button').addEventListener('click', function() {
            window.location.href = `viewer.html?pdf=${pdfFile}`; // 跳轉到 viewer.html 並加上 pdf 文件參數
        });

        // 获取已存储的翻页和 DIVE 得分
        let pageScore = sessionStorage.getItem('pageScore') || 0;
        let diveScores = JSON.parse(sessionStorage.getItem('diveScores')) || {};
        let totalDiveScore = Object.values(diveScores).reduce((a, b) => a + b, 0);

        // 设置翻页进度条
        document.getElementById('computationProgress').style.width = pageScore + '%';
        document.getElementById('computationProgress').textContent = pageScore + '%';

        // 设置 DIVE 得分进度条
        let diveScorePercentage = (totalDiveScore / 100) * 100;  // 假设 DIVE 满分为 100
        document.getElementById('musicProgress').style.width = diveScorePercentage + '%';
        document.getElementById('musicProgress').textContent = diveScorePercentage + '%';
    </script>
</body>
</html>
